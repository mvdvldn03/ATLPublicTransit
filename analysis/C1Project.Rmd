---
title: "C1 Project (Atlanta Public Transit)"
author: "Max Vandervelden"
date: "12/13/2021"
output: html_document
---

I wanted to do a project on my home city of Atlanta and its lack of public transportation. Traffic is a notorious problem in the city, and many blame the overeliance on cars for their excessive commutes. The main public operator which connects the city is MARTA (Metropolitan Atlanta Rapid Transit Authority), which operates a bus and a transit system. I took MARTA almost every single day to and from school since middle school, so I have good understanding of how the system works. 
One big issue with MARTA and something many have criticized it for is its racially-motivated coverage throughout the city:

  https://kinder.rice.edu/2017/02/08/new-study-examines-how-historic-racism-shaped-atlantas-transportation-network

MARTA has had significant struggles trying to expand into richer suburbs, namely Cobb, Clayton, and Gwinett, due to pushback from residents who see the operator as one which will bring in low-income, African Americans.

https://www.atlantamagazine.com/great-reads/marta-tsplost-transportation/

I wanted to research whether this stereotype of MARTA is actually true and whether this continues pushback has succeeded in its goal. Does MARTA serve, i.e. provide more access/shorter commutes to, lower income and certain race communities? Atlanta is also one of the top racially income unequal cities in the country. (https://www.atlantawealthbuilding.org/racial-wealth-gap). Specifically, I want to look at Atlanta's Neighborhood Statistical Areas (NSA) defined here:

  https://opendata.atlantaregional.com/datasets/d6298dee8938464294d3f49d473bcf15/explore?showTable=true
  https://fultoncountyopendata-fulcogis.opendata.arcgis.com/datasets/GARC::income-by-neighborhood-statistical-areas-2017/explore?showTable=true 
  
and their corresponding racial and income data. Then, I want to use Google Maps and its public transit feature to see how long commutes from each area are to get into downtown ATL and add the data on a corresponding tibble.

```{r}
library(sf)
library(tidyverse)
```

```{r}
shp = read_sf(dsn = "~/Downloads/ATL_NSAs/", layer = "City_of_Atlanta_Neighborhood_Statistical_Areas") %>%
  st_transform(crs=4326) %>%
  select(OBJECTID, STATISTICA, NEIGHBORHO, pop, white, black, asian, other, hispanic, geometry) %>%
  rename(ID = OBJECTID, GEOID = STATISTICA, neighborhoods = NEIGHBORHO)

times <- read_csv("~/Downloads/times.csv")
incomes <- read_csv("~/Downloads/IncomeNSA.csv") %>%
  select(GEOID, aMeanHHIncome_e) %>%
  rename(Mean_Income = aMeanHHIncome_e)
distances <- read_csv("~/Downloads/distance.csv")

full_data = shp %>%
  left_join(y = times, by=c("ID"="ID")) %>%
  left_join(y = distances, by=c("ID"="ID")) %>%
  left_join(y = incomes, by=c("GEOID"="GEOID")) 

ggplot() +
  geom_sf(data = full_data) +
  geom_sf(data = full_data[12,], fill = 'red')

full_data
```
```{r}
full_data %>% 
  ggplot() +
  geom_sf(aes(fill = black)) +
  scale_fill_gradient(low="white", high="red")

full_data %>% 
  ggplot() +
  geom_sf(aes(fill = black + hispanic )) +
  scale_fill_gradient(low="white", high="red")

full_data %>% 
  ggplot() +
  geom_sf(aes(fill = Mean_Income)) +
  scale_fill_gradient(low="white", high="red")

full_data %>%
  ggplot() + 
  geom_sf(aes(fill = Distance)) + 
  scale_fill_gradient(low="white", high="red")

full_data %>% 
  ggplot() +
  geom_sf(aes(fill = Time)) +
  scale_fill_gradient(low="white", high="red")

full_data %>% 
  filter(Distance > 3.0) %>%
  ggplot() +
  geom_sf(aes(fill = Time/Distance)) +
  scale_fill_gradient(low="white", high="red") 
```

Assumption: All groups are affected equally by the pandemic and MARTA's reduction of services
Assumption: Same useage rates, access != useage

```{r}
full_data %>%
  ggplot(aes(x = black, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)

full_data %>%
  ggplot(aes(x = black + hispanic, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)

full_data %>%
  ggplot(aes(x = Mean_Income, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)
```

```{r}
full_data %>%
  filter(Distance > 5.0) %>%
  ggplot(aes(x = black, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)

full_data %>%
  filter(Distance > 7.0) %>%
  ggplot(aes(x = black, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)

full_data %>%
  filter(Distance > 7.0) %>%
  ggplot(aes(x = Mean_Income, y = Time/Distance)) +
  geom_point() +
  geom_smooth(method="lm", se = FALSE)
```